{% extends 'settle/base.html' %}
{% load staticfiles %}

{% block style_block %}
    <!-- Import custom CSS here! -->
{% endblock %}

{% block title_block %}Home{% endblock %}

{% block body_block %}
    <!-- Code here! -->
    {% if user.is_authenticated %}
      <p>Logged in: {{ user }}</p>
    {% endif %}
    <div class="row infinite-container">
        {% for post in posts %}

            <div class="col-sm-4 infinite-item" align="center" style="padding-top:45px">
                <p class="col sm-4" style="background-color:#56c9ff;padding:2px;font-size:1.2vw">{{ post.author }}</p>
                <a href="{% url "post" post.id %}"><img class="img-fluid" style="max-height:auto;width: 525px;" src="{{ MEDIA_URL }}{{ post.picture }}" alt="pic"></a>
                <div class = "row" style= "padding-top:10px">
                    <div class = "col sm-4">
                        <button type = "button" class= "btn" style="background-color:{{ post.game_tag.colour }}">{{ post.game_tag }}</button>
                    </div>
                    <div class = "col sm-8">
                        <div class = "row">
                            <div class = "col sm-3 mr-auto">
                                <button type = "button" class= "btn" style="background-color:{{ post.info_tags.all.0.colour }}">{{ post.info_tags.all.0 }}</button>
                            </div>
                            {% if post.info_tags.all.1 %}
                            <div class = "col sm-3 mr-auto">
                                <button type = "button" class= "btn" style="background-color:{{ post.info_tags.all.1.colour }}">{{ post.info_tags.all.1 }}</button>
                            </div>
                            {% endif %}
                            {% if post.info_tags.all.2 %}
                            <div class = "col sm-3 mr-auto">
                                <button type = "button" class= "btn" style="background-color:{{ post.info_tags.all.2.colour }}">{{ post.info_tags.all.2 }}</button>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            {% if forloop.counter|divisibleby:3 %}
                </div>
                <div class="row infinite-container">
            {% endif %}

        {% endfor %}
    </div>
    
      {% if posts.has_next %}
        <a class="infinite-more-link" href="?page={{ posts.next_page_number }}"></a>
      {% endif %}
    
      <div class="loading" style="display: none;">
        Loading...
      </div>
    
{% endblock %}

{% block script_block %}
    <!-- Import custom JS here! -->
    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/infinite.min.js' %}"></script>
    <script>
        var infinite = new Waypoint.Infinite({
          element: $('.infinite-container')[0],
          onBeforePageLoad: function () {
            $('.loading').show();
          },
          onAfterPageLoad: function ($items) {
            $('.loading').hide();
          }
        });
      </script>
{% endblock %}